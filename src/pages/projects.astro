---
import BaseLayout from '../layouts/BaseLayout.astro';
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const sortedProjects = projects.sort((a, b) => {
  const dateA = a.data.date ? new Date(a.data.date).getTime() : 0;
  const dateB = b.data.date ? new Date(b.data.date).getTime() : 0;
  return dateB - dateA;
});
---

<BaseLayout title="Projects - Piyush Jain" description="Personal and technical projects">
  <div class="max-w-4xl mx-auto">
    <h1 class="text-4xl md:text-5xl font-bold mb-8">Projects</h1>
    
    <p class="text-lg text-[rgb(var(--text-secondary))] mb-12">
      A collection of personal and technical projects I've worked on.
    </p>

    {sortedProjects.length > 0 ? (
      <div class="space-y-6">
        {sortedProjects.map((project) => (
          <article class="p-6 border border-[rgb(var(--border-color))] rounded-lg hover:shadow-md transition-shadow">
            <div class="flex flex-col sm:flex-row sm:items-start sm:justify-between mb-2">
              <h2 class="text-2xl font-bold mb-2 sm:mb-0">{project.data.title}</h2>
              {project.data.date && (
                <time class="text-sm text-[rgb(var(--text-secondary))]">
                  {new Date(project.data.date).toLocaleDateString('en-US', { 
                    year: 'numeric', 
                    month: 'short' 
                  })}
                </time>
              )}
            </div>
            
            <p class="text-[rgb(var(--text-secondary))] mb-4">{project.data.description}</p>
            
            {project.data.tags && project.data.tags.length > 0 && (
              <div class="flex flex-wrap gap-2 mb-4">
                {project.data.tags.map((tag) => (
                  <span class="px-3 py-1 text-xs font-medium bg-slate-100 dark:bg-slate-800 rounded-full">
                    {tag}
                  </span>
                ))}
              </div>
            )}
            
            <div class="flex gap-4">
              {project.data.repo && (
                <a 
                  href={project.data.repo} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="text-sm font-medium hover:underline"
                >
                  View Code →
                </a>
              )}
              {project.data.link && (
                <a 
                  href={project.data.link} 
                  target="_blank" 
                  rel="noopener noreferrer"
                  class="text-sm font-medium hover:underline"
                >
                  Live Demo →
                </a>
              )}
            </div>
          </article>
        ))}
      </div>
    ) : (
      <p class="text-[rgb(var(--text-secondary))]">Projects coming soon.</p>
    )}
  </div>
</BaseLayout>
